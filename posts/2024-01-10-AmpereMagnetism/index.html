<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="JHM">
<meta name="dcterms.date" content="2024-01-10">
<meta name="description" content="Magnetism interacts in every fundamental experiment in physics, yet magnetism is not so well understood. Here we review Andre Marie Ampere’s fundamantal principle of the equivalence of magneto and electrical forces, and it’s consequences. For example we recall Ampere’s observation that the trivial calculus identity div(curl)=0 essentially implies the nonexistence of magnetic monopoles and one of Maxwell’s equations, namely div(B)=0. This again is fundamental insight of Ampere.">

<title>jhm - Ampere, Weber, and Magnetism the Disposable Hypothesis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">jhm</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About JHM</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jhmartel/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/_jhmlabs" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Ampere, Weber, and Magnetism the Disposable Hypothesis</h1>
                  <div>
        <div class="description">
          Magnetism interacts in every fundamental experiment in physics, yet magnetism is not so well understood. Here we review Andre Marie Ampere’s fundamantal principle of the equivalence of magneto and electrical forces, and it’s consequences. For example we recall Ampere’s observation that the trivial calculus identity <span class="math inline">\(div(curl)=0\)</span> essentially implies the nonexistence of magnetic monopoles and one of Maxwell’s equations, namely <span class="math inline">\(div(B)=0\)</span>. This again is fundamental insight of Ampere.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">weber</div>
                <div class="quarto-category">ampere</div>
                <div class="quarto-category">magnetism</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>JHM </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 10, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="magnetic-effects-in-almost-all-fundamental-experiments" class="level2">
<h2 class="anchored" data-anchor-id="magnetic-effects-in-almost-all-fundamental-experiments">Magnetic Effects In Almost All Fundamental Experiments</h2>
<p>Magnetic phenomena plays critical role in nearly all fundamental experiments in physics. Briefly we have:</p>
<ul>
<li>Oersted’s 1820 deflection of compass needle by a current.</li>
<li>Faraday’s introduction of “electromagnetic” lines of force (1851) to explain his experiments on voltaic and magneto induction (1830s).</li>
<li>Faraday’s electromagnetic lines of force are formalized by <span class="math inline">\(E,B\)</span> in Maxwell’s equations (~1860s).</li>
<li>Hall’s 1879 experiment deciding the sign of charge carriers in conductors.</li>
<li>Zeeman’s 1897 experiment on the splitting of spectral lines in magnetic fields.</li>
<li>Kaufmann’s 1901 experiment on deflection of electric particles in magnetic fields.</li>
<li>Stern-Gerlach 1922 experiments on interaction of “spin” with magnetic moments.</li>
</ul>
<p>However we insist that magnetism remains poorly understood. Even today efforts are made to “discover” magnetic monopoles, and it’s forgotten that Ampere <span class="citation" data-cites="ampere">(<a href="#ref-ampere" role="doc-biblioref">Assis and Chaib 2015, 19.2</a>)</span> demonstrated the equivalence of magnetic and electric forces, and Ampere [ampere, 19.1] demonstrated the <em>nonexistence</em> of magnetic monopoles via the elementary observation that <span class="math inline">\(div(curl)=0\)</span>. Thus Ampere found the idea of magnetic poles and dipoles as superfluous and disposable <em>hypotheses</em>.</p>
<p>Another fundamental critique of magnetic interactions due to Ampere <span class="citation" data-cites="ampere">(<a href="#ref-ampere" role="doc-biblioref">Assis and Chaib 2015, 19.3</a>)</span> is that these interactions are neither fundamental nor primitive. Indeed Oersted, Faraday, Maxwell, et. al., all postulate interactions between current carrying wires and magnetic poles. They assume the interaction between electric charges in motion and magnetic fields is something fundamental. Yet Ampere argues that elementary forces must act between objects of the same nature. For example, in Coulomb’s electrostatic law, one describes mutual interaction between electric charges. In Newton’s gravitational law, one describes the gravitational force between two masses. Thus Ampere rejects the idea of interactions between objects of different natures as something fundamental. To illustrate Ampere in his own words, we quote from Ampere [as cited above]:</p>
<p>“<em>1st: Every explanation in the sciences consists in discovering a primitive fact expressed by a general law which, once presented, can be utilized in order to deduce from it all other [facts or laws].</em>”</p>
<p>“<em>2nd: The primitive fact cannot be here the action between a voltaic conductor and a magnet, because, these two things being heterogeneous, the mutual action between them must necessarily be more complicated than that [mutual action] which takes place between two magnets, or than that [mutual action] which I [Ampere] discovered between two conductors</em>”</p>
<p>“<em>Is it not evident that one should look for the primitive fact in the action between two things of the same nature, like two conductors, and not in that action between two heterogeneous things, like a conductor and a magnet?</em>”</p>
<p>As we describe below, this heterogeneity of the Maxwellian electromagnetic fields <span class="math inline">\(E,B\)</span> is the cause of Einstein’s perceived asymmetry in the Maxwell equations.</p>
</section>
<section id="faradays-law-of-induction" class="level2">
<h2 class="anchored" data-anchor-id="faradays-law-of-induction">Faraday’s Law of Induction</h2>
<p>Before we present Einstein’s view on magnetism and special relativity, we briefly review Faraday’s law of induction. From our perspective, we see Faraday’s results on induction as having two parts:</p>
<ol type="a">
<li><p>we have voltaic induction, where we have interactions of time-varying electric fields inducing secondary electric fields in conductors. This is an induction between homogeneous elements, namely conductors interacting with conductors.</p></li>
<li><p>in application one considers Faraday “magneto” induction, which is the basis behind electrical generators, where mechanical energy is converted into electrical energy.</p></li>
</ol>
<p>For example, standard textbooks <span class="citation" data-cites="siskind">(<a href="#ref-siskind" role="doc-biblioref">Siskind 1959, 1</a>)</span> say: “generator action can take place when, and only when, there is relative motion between conducting wires (usually copper) and magnetic lines of force.” Examples of generators are steam turbines, gasoline engines, electric motors, or hand-powered cranks, etc.. Rotating electrical generators consist of (i) an even set of electromagnets or permanent magnets and (ii) a laminated steel core containing current carrying copper wires (“armature windings”).</p>
<p>“In the DC generator, the armature winding is mechanically rotated through the stationary magnetic fields created by the electromagnets or permanent magnets.”</p>
<p>“In the AC generator, the electromagnets or the permanent magnets and their accompanying magnetic fields are rotated with respect to the stationary armature winding.”</p>
<p>If we suppose the magnetic field <span class="math inline">\(B\)</span> is properly defined and if <span class="math inline">\(C\)</span> is a conductor, then Faraday’s law of induction says variations in <span class="math inline">\(flux(B)\)</span> along the conductor generates a reciprocal emf in the conductor according to the formula: <span class="math display">\[\text{emf}:=\int_C E\cdot ds=-\frac{d}{dt} \int_S B \cdot dS=-\int_S \frac{dB}{dt} \cdot dS\]</span> where <span class="math inline">\(S\)</span> is any surface which bounds the conductor <span class="math inline">\(\partial S=C\)</span>. The induction formula says the circulation of <span class="math inline">\(E\)</span> along the conductor boundary <span class="math inline">\(C=\partial S\)</span> is equal to the negative flux of <span class="math inline">\(\partial{B}/\partial t\)</span> along any bounding surface. We remark that Faraday’s law is invariant whether the magnet is in motion and the conductor at rest, or vice versa, or a combination of both.</p>
</section>
<section id="einstein-on-maxwell-equations-and-magnetism-as-relativistic-effect" class="level2">
<h2 class="anchored" data-anchor-id="einstein-on-maxwell-equations-and-magnetism-as-relativistic-effect">Einstein on Maxwell Equations and Magnetism as Relativistic Effect</h2>
<p>There is another important influence of magnetism on physics, and this is Einstein’s interpretation of magnetism as a special relativistic effect. An interesting treatment is provided by Prof.&nbsp;J.D. Norton <a href="https://sites.pitt.edu/~jdnorton/teaching/HPS_0410/chapters/origins_pathway/index.html">here</a></p>
<p>There does not appear to be any asymmetry in Faraday’s law of induction. However Einstein’s 1905 paper <span class="citation" data-cites="einstein1905">(<a href="#ref-einstein1905" role="doc-biblioref">Einstein 1905</a>)</span> treatment of magnetism as an effect of special relativity begins from the premise that there is an asymmetry. To paraphrase from the first paragraph: “<em>Maxwell’s equations – as usually understood at the present time – lead to asymmetries which do not appear inherent in the phenomena, for example, in the force interactions of a magnet and conductor in relative motion.</em>”</p>
<p>What is the asymmetry? It’s not easy to precisely locate in the text of Einstein’s paper, but it appears to be this:</p>
<ul>
<li><strong>Einstein’s Asymmetry:</strong> The heterogeneous magnetic-electric structure of solutions to Maxwell’s equations is not Lorentz invariant. Solutions <span class="math inline">\((E,B)\)</span> to Maxwell’s equations in an inertial frame <span class="math inline">\(K\)</span> can satisfy <span class="math inline">\(E=0\)</span> or <span class="math inline">\(B=0\)</span>, but in another inertial frame <span class="math inline">\(K'\)</span> the solutions <span class="math inline">\((E', B')\)</span> to Maxwell’s equations can satisfy <span class="math inline">\(E'\neq 0\)</span> or <span class="math inline">\(B' \neq 0\)</span>. Equivalently, a solution might be strictly magnetic or electric in inertial frame <span class="math inline">\(K\)</span> and a combination of electric and magnetic solutions in <span class="math inline">\(K'\)</span>.</li>
</ul>
<p>Therefore Einstein’s asymmetry consists in the inertial frames <span class="math inline">\(K, K'\)</span> having different “physical” descriptions of the same event (the induced emf in the conductor). The apparent asymmetry is a consequence of the <em>heterogeneity</em> inherent to Maxwell’s equations, namely the interactions of fields <span class="math inline">\(E,B\)</span> with distinct physical natures, namely electric versus magnetic. This noninvariance of heterogeneity follows from Einstein’s application of Lorentz transformations to Maxwell’s equations.</p>
</section>
<section id="ampere-weber-explanation-of-faraday-magneto-induction" class="level2">
<h2 class="anchored" data-anchor-id="ampere-weber-explanation-of-faraday-magneto-induction">Ampere-Weber Explanation of Faraday Magneto Induction</h2>
<p>In Ampere’s electrodynamics, magnetic forces are induced by electrical currents in secondary circuits. Therefore in Ampere’s system there is only relational electrical force between current elements. Magnetism in Ampere’s model is explained at the atom physical level by bound electron orbits around heavy central atomic protons. A permament magnet has a lattice structure such that the angular momenta of the electrical atoms are stuctured and have an additive coherent net effect. This means the moments are not randomly aligned but highly correlated in some parallel direction. Therefore if a permament magnet is at rest macroscopically, it’s constituent electrical molecules have dynamic orbits with parallel angular momenta. If the conductor is in motion relative to the permanent magnet, then we have a resultant relative motion of the conductor with all the angular momenta of the constituent electrical particles in the magnet.</p>
<p>Thus in Ampere’s setting, we find voltaic induction (relative motion of conductors) and the magneto induction (relative motion of magnet and conductor) become equivalent. Microscopically there is only induction principle, but macroscopically it manifests somewhat different in permanent magnets.</p>
</section>
<section id="where-to-from-here" class="level2">
<h2 class="anchored" data-anchor-id="where-to-from-here">Where to from here?</h2>
<p>Ampere wrote <span class="citation" data-cites="ampere">(<a href="#ref-ampere" role="doc-biblioref">Assis and Chaib 2015, 29.19</a>)</span>:</p>
<p><em>“Throughout history, whenever hitherto unrelated phenomena have been reduced to a single principle, a period has followed in which many new facts have been discovered, because a new approach in the conception of causes suggests a multitude of new experiments and explanations. It is thus that Volta’s demonstration of the identity of galvanism and electricity was accompanied by the construction of the electric battery with all the discoveries which have sprung from this admirable device….”</em></p>
<p>In the textbook @[nc, 7.5.2] the total Hamiltonian alleged to describe the electrons in atoms behaves with a Hamiltonian of the form <span class="math display">\[H_{std}=\sum \frac{|p_k|^2}{2m} -\frac{Ze^2}{r_k} +H_{rel}+H_{ee}+H_{so}+H_{hf}, \]</span> where:</p>
<ul>
<li><p>the first terms describe the energy balance of kinetic energy with the Coulomb attraction to the positively charged nucleus.</p></li>
<li><p><span class="math inline">\(H_{rel}\)</span> is a “relativistic correction term”.</p></li>
<li><p><span class="math inline">\(H_{ee}\)</span> is an electron-electron interaction energy arising from so-called “fermionic” nature of electrons.</p></li>
<li><p><span class="math inline">\(H_{so}\)</span> is the spin orbit interaction, which is supposed to be the interaction of the electron spin interacting with the magnetic field generated by its motion around the atom.</p></li>
<li><p><span class="math inline">\(H_{hf}\)</span> is the so=called hyperfine interaction which is supposed to be the electron spin interaction with the magnetic field generated by the nucleus.</p></li>
</ul>
<p>The standard Hamiltonian <span class="math inline">\(H_{std}\)</span> is obviously highly <em>heterogeneous</em>.</p>
<p>But the essence of simplicity is Ampere-Weber’s hypothesis that all atoms are electrical molecules consisting of positive and negative point electric charges. But Weber does not simply take the Coulomb force law, but Weber proposes his fundamental law of electrodynamic interaction represented in the Hamiltonian <span class="math display">\[H_{w}=\sum_{ij} \frac{\mu_{ij}}{2} {\nu_{ij}}^2 + \frac{q_i q_j}{r_{ij}} (1-\frac{\nu_{ij}^2}{2c^2}),\]</span> where <span class="math inline">\(\nu_{ij}:=r'_{ij} = {\hat{r}_{ij}} \cdot v_{ij}\)</span>. In otherwords, Weber’s Hamiltonian depends strictly on the scalar relational variables <span class="math inline">\(r_{ij}, \nu_{ij}\)</span>. Weber’s Hamiltonian is the sum of all pairwise interactions in the electrical system, i.e.&nbsp;there is no reference to three-fold or four-fold, etc., interactions.</p>
<p>Our ultimate opinion is that Weber’s Hamiltonian <span class="math inline">\(H_w\)</span> is the fundamental homogeneous Hamiltonian, while the standard model’s Hamiltonain <span class="math inline">\(H_{std}\)</span> is heterogeneous. We must imagine that Ampere would insist on Weber’s Hamiltonian being developed as far as possible. This is our goal.</p>
<p>[To be continued –JHM]</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-ampere" class="csl-entry" role="listitem">
Assis, Andre Koch Torres, and JPMC Chaib. 2015. <span>“Amp<span>è</span>re’s Electrodynamics.”</span> <em>Available Under: Http://Www. Ifi. Unicamp. Br/~ Assis/Amperes-Electrodynamics. Pdf</em>, 72–80.
</div>
<div id="ref-einstein1905" class="csl-entry" role="listitem">
Einstein, Albert. 1905. <span>“On the Electrodynamics of Moving Bodies.”</span> <em>Annalen Der Physik</em> 17 (10): 891–921.
</div>
<div id="ref-siskind" class="csl-entry" role="listitem">
Siskind, Charles Seymour. 1959. <span>“Electrical Machines: Direct and Alternating Current.”</span> <em>McGraw-Hill</em>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>